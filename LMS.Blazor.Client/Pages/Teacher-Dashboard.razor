@page "/teacher-dashboard"
@rendermode InteractiveWebAssembly
@using LMS.Blazor.Client.Services
@using LMS.Shared.DTOs
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@* @attribute [Authorize(Roles = "Teacher")] *@

<div class="dashboard-container">
    <!-- Header -->
    <div class="dashboard-header">
        <h1>Welcome back, @userName!</h1>
    </div>

    <!-- Tabs for Navigation -->
    <div class="dashboard-tabs">
        <button class="btn btn-primary" @onclick="SetActiveTabCourses">Courses</button>
        <button class="btn btn-primary" @onclick="SetActiveTabUsers">Users</button>
        <button class="btn btn-primary" @onclick="SetActiveTabActivities">Activities</button>
    </div>

    <!-- Courses Tab -->
    @if (activeTab == "courses")
    {
        <div class="dashboard-section">
            <h2>Courses</h2>
            <button class="btn btn-success" @onclick="ShowCreateCourseModal">Create New Course</button>

            @if (courseDto ==  null)
            {
                <p>Loading courses...</p>
            }
            else if (!courseDto.Any())
            {
                <p>No courses found.</p>
            }
            else
            {
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var course in courseDto)
                        {
                            <tr>
                                <td>@course.Name</td>
                                <td>@course.Description</td>
                                <td>@course.StartDate.ToShortDateString()</td>
                                <td>@course.EndDate.ToShortDateString()</td>
                                <td>
                                    <button class="btn btn-warning" @onclick="() => ShowEditCourseModal(course)">Edit</button>
                                    @* <button class="btn btn-danger" @onclick="() => DeleteCourse(course.CourseId)">Delete</button> *@
                                    <button class="btn btn-info" @onclick="() => ViewModules(course.CourseId)">View Modules</button>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    }

    <!-- Users Tab -->
    @if (activeTab == "users")
    {
        <div class="dashboard-section">
            <h2>Users</h2>
            <button class="btn btn-success" @onclick="ShowCreateUserModal">Create New User</button>

            @if (users == null)
            {
                <p>Loading users...</p>
            }
            else if (!users.Any())
            {
                <p>No users found.</p>
            }
            else
            {
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var user in users)
                        {
                            <tr>
                                <td>@user.FirstName @user.LastName</td>
                                <td>@user.Email</td>
                                <td>@user.Role</td>
                                <td>
                                    <button class="btn btn-warning" @onclick="() => ShowEditUserModal(user)">Edit</button>
                                    @* <button class="btn btn-danger" @onclick="() => DeleteUser(user.Id)">Delete</button> *@
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    }

    <!-- Activities Tab -->
    @if (activeTab == "activities")
    {
        <div class="dashboard-section">
            <h2>Activities</h2>
            <button class="btn btn-success" @onclick="ShowCreateActivityModal">Create New Activity</button>

            @if (activities == null)
            {
                <p>Loading activities...</p>
            }
            else if (!activities.Any())
            {
                <p>No activities found.</p>
            }
            else
            {
                <table class="table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Description</th>
                            <th>Due Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var activity in activities)
                        {
                            <tr>
                                <td>@activity.Name</td>
                                <td>@activity.Description</td>
                                <td>@activity.EndDate.ToShortDateString()</td>
                                <td>
                                    <button class="btn btn-warning" @onclick="() => ShowEditActivityModal(activity)">Edit</button>
                                    @* <button class="btn btn-danger" @onclick="() => DeleteActivity(activity.ActivityId)">Delete</button> *@
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    }
</div>

@code {
    
}